revoke delete on table "public"."TbAcessoIntelBras" from "anon";

revoke insert on table "public"."TbAcessoIntelBras" from "anon";

revoke references on table "public"."TbAcessoIntelBras" from "anon";

revoke select on table "public"."TbAcessoIntelBras" from "anon";

revoke trigger on table "public"."TbAcessoIntelBras" from "anon";

revoke truncate on table "public"."TbAcessoIntelBras" from "anon";

revoke update on table "public"."TbAcessoIntelBras" from "anon";

revoke delete on table "public"."TbAcessoIntelBras" from "authenticated";

revoke insert on table "public"."TbAcessoIntelBras" from "authenticated";

revoke references on table "public"."TbAcessoIntelBras" from "authenticated";

revoke select on table "public"."TbAcessoIntelBras" from "authenticated";

revoke trigger on table "public"."TbAcessoIntelBras" from "authenticated";

revoke truncate on table "public"."TbAcessoIntelBras" from "authenticated";

revoke update on table "public"."TbAcessoIntelBras" from "authenticated";

revoke delete on table "public"."TbAcessoIntelBras" from "service_role";

revoke insert on table "public"."TbAcessoIntelBras" from "service_role";

revoke references on table "public"."TbAcessoIntelBras" from "service_role";

revoke select on table "public"."TbAcessoIntelBras" from "service_role";

revoke trigger on table "public"."TbAcessoIntelBras" from "service_role";

revoke truncate on table "public"."TbAcessoIntelBras" from "service_role";

revoke update on table "public"."TbAcessoIntelBras" from "service_role";

revoke delete on table "public"."TbChamados" from "anon";

revoke insert on table "public"."TbChamados" from "anon";

revoke references on table "public"."TbChamados" from "anon";

revoke select on table "public"."TbChamados" from "anon";

revoke trigger on table "public"."TbChamados" from "anon";

revoke truncate on table "public"."TbChamados" from "anon";

revoke update on table "public"."TbChamados" from "anon";

revoke delete on table "public"."TbChamados" from "authenticated";

revoke insert on table "public"."TbChamados" from "authenticated";

revoke references on table "public"."TbChamados" from "authenticated";

revoke select on table "public"."TbChamados" from "authenticated";

revoke trigger on table "public"."TbChamados" from "authenticated";

revoke truncate on table "public"."TbChamados" from "authenticated";

revoke update on table "public"."TbChamados" from "authenticated";

revoke delete on table "public"."TbChamados" from "service_role";

revoke insert on table "public"."TbChamados" from "service_role";

revoke references on table "public"."TbChamados" from "service_role";

revoke select on table "public"."TbChamados" from "service_role";

revoke trigger on table "public"."TbChamados" from "service_role";

revoke truncate on table "public"."TbChamados" from "service_role";

revoke update on table "public"."TbChamados" from "service_role";

revoke delete on table "public"."TbEtiqueta" from "anon";

revoke insert on table "public"."TbEtiqueta" from "anon";

revoke references on table "public"."TbEtiqueta" from "anon";

revoke select on table "public"."TbEtiqueta" from "anon";

revoke trigger on table "public"."TbEtiqueta" from "anon";

revoke truncate on table "public"."TbEtiqueta" from "anon";

revoke update on table "public"."TbEtiqueta" from "anon";

revoke delete on table "public"."TbEtiqueta" from "authenticated";

revoke insert on table "public"."TbEtiqueta" from "authenticated";

revoke references on table "public"."TbEtiqueta" from "authenticated";

revoke select on table "public"."TbEtiqueta" from "authenticated";

revoke trigger on table "public"."TbEtiqueta" from "authenticated";

revoke truncate on table "public"."TbEtiqueta" from "authenticated";

revoke update on table "public"."TbEtiqueta" from "authenticated";

revoke delete on table "public"."TbEtiqueta" from "service_role";

revoke insert on table "public"."TbEtiqueta" from "service_role";

revoke references on table "public"."TbEtiqueta" from "service_role";

revoke select on table "public"."TbEtiqueta" from "service_role";

revoke trigger on table "public"."TbEtiqueta" from "service_role";

revoke truncate on table "public"."TbEtiqueta" from "service_role";

revoke update on table "public"."TbEtiqueta" from "service_role";

revoke delete on table "public"."TbFuncionario" from "anon";

revoke insert on table "public"."TbFuncionario" from "anon";

revoke references on table "public"."TbFuncionario" from "anon";

revoke select on table "public"."TbFuncionario" from "anon";

revoke trigger on table "public"."TbFuncionario" from "anon";

revoke truncate on table "public"."TbFuncionario" from "anon";

revoke update on table "public"."TbFuncionario" from "anon";

revoke delete on table "public"."TbFuncionario" from "authenticated";

revoke insert on table "public"."TbFuncionario" from "authenticated";

revoke references on table "public"."TbFuncionario" from "authenticated";

revoke select on table "public"."TbFuncionario" from "authenticated";

revoke trigger on table "public"."TbFuncionario" from "authenticated";

revoke truncate on table "public"."TbFuncionario" from "authenticated";

revoke update on table "public"."TbFuncionario" from "authenticated";

revoke delete on table "public"."TbFuncionario" from "service_role";

revoke insert on table "public"."TbFuncionario" from "service_role";

revoke references on table "public"."TbFuncionario" from "service_role";

revoke select on table "public"."TbFuncionario" from "service_role";

revoke trigger on table "public"."TbFuncionario" from "service_role";

revoke truncate on table "public"."TbFuncionario" from "service_role";

revoke update on table "public"."TbFuncionario" from "service_role";

revoke delete on table "public"."TbPonto" from "anon";

revoke insert on table "public"."TbPonto" from "anon";

revoke references on table "public"."TbPonto" from "anon";

revoke select on table "public"."TbPonto" from "anon";

revoke trigger on table "public"."TbPonto" from "anon";

revoke truncate on table "public"."TbPonto" from "anon";

revoke update on table "public"."TbPonto" from "anon";

revoke delete on table "public"."TbPonto" from "authenticated";

revoke insert on table "public"."TbPonto" from "authenticated";

revoke references on table "public"."TbPonto" from "authenticated";

revoke select on table "public"."TbPonto" from "authenticated";

revoke trigger on table "public"."TbPonto" from "authenticated";

revoke truncate on table "public"."TbPonto" from "authenticated";

revoke update on table "public"."TbPonto" from "authenticated";

revoke delete on table "public"."TbPonto" from "service_role";

revoke insert on table "public"."TbPonto" from "service_role";

revoke references on table "public"."TbPonto" from "service_role";

revoke select on table "public"."TbPonto" from "service_role";

revoke trigger on table "public"."TbPonto" from "service_role";

revoke truncate on table "public"."TbPonto" from "service_role";

revoke update on table "public"."TbPonto" from "service_role";

revoke delete on table "public"."TbTag" from "anon";

revoke insert on table "public"."TbTag" from "anon";

revoke references on table "public"."TbTag" from "anon";

revoke select on table "public"."TbTag" from "anon";

revoke trigger on table "public"."TbTag" from "anon";

revoke truncate on table "public"."TbTag" from "anon";

revoke update on table "public"."TbTag" from "anon";

revoke delete on table "public"."TbTag" from "authenticated";

revoke insert on table "public"."TbTag" from "authenticated";

revoke references on table "public"."TbTag" from "authenticated";

revoke select on table "public"."TbTag" from "authenticated";

revoke trigger on table "public"."TbTag" from "authenticated";

revoke truncate on table "public"."TbTag" from "authenticated";

revoke update on table "public"."TbTag" from "authenticated";

revoke delete on table "public"."TbTag" from "service_role";

revoke insert on table "public"."TbTag" from "service_role";

revoke references on table "public"."TbTag" from "service_role";

revoke select on table "public"."TbTag" from "service_role";

revoke trigger on table "public"."TbTag" from "service_role";

revoke truncate on table "public"."TbTag" from "service_role";

revoke update on table "public"."TbTag" from "service_role";

revoke delete on table "public"."TbTicket" from "anon";

revoke insert on table "public"."TbTicket" from "anon";

revoke references on table "public"."TbTicket" from "anon";

revoke select on table "public"."TbTicket" from "anon";

revoke trigger on table "public"."TbTicket" from "anon";

revoke truncate on table "public"."TbTicket" from "anon";

revoke update on table "public"."TbTicket" from "anon";

revoke delete on table "public"."TbTicket" from "authenticated";

revoke insert on table "public"."TbTicket" from "authenticated";

revoke references on table "public"."TbTicket" from "authenticated";

revoke select on table "public"."TbTicket" from "authenticated";

revoke trigger on table "public"."TbTicket" from "authenticated";

revoke truncate on table "public"."TbTicket" from "authenticated";

revoke update on table "public"."TbTicket" from "authenticated";

revoke delete on table "public"."TbTicket" from "service_role";

revoke insert on table "public"."TbTicket" from "service_role";

revoke references on table "public"."TbTicket" from "service_role";

revoke select on table "public"."TbTicket" from "service_role";

revoke trigger on table "public"."TbTicket" from "service_role";

revoke truncate on table "public"."TbTicket" from "service_role";

revoke update on table "public"."TbTicket" from "service_role";

revoke delete on table "public"."TbTicketResumo" from "anon";

revoke insert on table "public"."TbTicketResumo" from "anon";

revoke references on table "public"."TbTicketResumo" from "anon";

revoke select on table "public"."TbTicketResumo" from "anon";

revoke trigger on table "public"."TbTicketResumo" from "anon";

revoke truncate on table "public"."TbTicketResumo" from "anon";

revoke update on table "public"."TbTicketResumo" from "anon";

revoke delete on table "public"."TbTicketResumo" from "authenticated";

revoke insert on table "public"."TbTicketResumo" from "authenticated";

revoke references on table "public"."TbTicketResumo" from "authenticated";

revoke select on table "public"."TbTicketResumo" from "authenticated";

revoke trigger on table "public"."TbTicketResumo" from "authenticated";

revoke truncate on table "public"."TbTicketResumo" from "authenticated";

revoke update on table "public"."TbTicketResumo" from "authenticated";

revoke delete on table "public"."TbTicketResumo" from "service_role";

revoke insert on table "public"."TbTicketResumo" from "service_role";

revoke references on table "public"."TbTicketResumo" from "service_role";

revoke select on table "public"."TbTicketResumo" from "service_role";

revoke trigger on table "public"."TbTicketResumo" from "service_role";

revoke truncate on table "public"."TbTicketResumo" from "service_role";

revoke update on table "public"."TbTicketResumo" from "service_role";

revoke delete on table "public"."TbUnidade" from "anon";

revoke insert on table "public"."TbUnidade" from "anon";

revoke references on table "public"."TbUnidade" from "anon";

revoke select on table "public"."TbUnidade" from "anon";

revoke trigger on table "public"."TbUnidade" from "anon";

revoke truncate on table "public"."TbUnidade" from "anon";

revoke update on table "public"."TbUnidade" from "anon";

revoke delete on table "public"."TbUnidade" from "authenticated";

revoke insert on table "public"."TbUnidade" from "authenticated";

revoke references on table "public"."TbUnidade" from "authenticated";

revoke select on table "public"."TbUnidade" from "authenticated";

revoke trigger on table "public"."TbUnidade" from "authenticated";

revoke truncate on table "public"."TbUnidade" from "authenticated";

revoke update on table "public"."TbUnidade" from "authenticated";

revoke delete on table "public"."TbUnidade" from "service_role";

revoke insert on table "public"."TbUnidade" from "service_role";

revoke references on table "public"."TbUnidade" from "service_role";

revoke select on table "public"."TbUnidade" from "service_role";

revoke trigger on table "public"."TbUnidade" from "service_role";

revoke truncate on table "public"."TbUnidade" from "service_role";

revoke update on table "public"."TbUnidade" from "service_role";

revoke delete on table "public"."TbVisita" from "anon";

revoke insert on table "public"."TbVisita" from "anon";

revoke references on table "public"."TbVisita" from "anon";

revoke select on table "public"."TbVisita" from "anon";

revoke trigger on table "public"."TbVisita" from "anon";

revoke truncate on table "public"."TbVisita" from "anon";

revoke update on table "public"."TbVisita" from "anon";

revoke delete on table "public"."TbVisita" from "authenticated";

revoke insert on table "public"."TbVisita" from "authenticated";

revoke references on table "public"."TbVisita" from "authenticated";

revoke select on table "public"."TbVisita" from "authenticated";

revoke trigger on table "public"."TbVisita" from "authenticated";

revoke truncate on table "public"."TbVisita" from "authenticated";

revoke update on table "public"."TbVisita" from "authenticated";

revoke delete on table "public"."TbVisita" from "service_role";

revoke insert on table "public"."TbVisita" from "service_role";

revoke references on table "public"."TbVisita" from "service_role";

revoke select on table "public"."TbVisita" from "service_role";

revoke trigger on table "public"."TbVisita" from "service_role";

revoke truncate on table "public"."TbVisita" from "service_role";

revoke update on table "public"."TbVisita" from "service_role";

revoke delete on table "public"."TbVisitante" from "anon";

revoke insert on table "public"."TbVisitante" from "anon";

revoke references on table "public"."TbVisitante" from "anon";

revoke select on table "public"."TbVisitante" from "anon";

revoke trigger on table "public"."TbVisitante" from "anon";

revoke truncate on table "public"."TbVisitante" from "anon";

revoke update on table "public"."TbVisitante" from "anon";

revoke delete on table "public"."TbVisitante" from "authenticated";

revoke insert on table "public"."TbVisitante" from "authenticated";

revoke references on table "public"."TbVisitante" from "authenticated";

revoke select on table "public"."TbVisitante" from "authenticated";

revoke trigger on table "public"."TbVisitante" from "authenticated";

revoke truncate on table "public"."TbVisitante" from "authenticated";

revoke update on table "public"."TbVisitante" from "authenticated";

revoke delete on table "public"."TbVisitante" from "service_role";

revoke insert on table "public"."TbVisitante" from "service_role";

revoke references on table "public"."TbVisitante" from "service_role";

revoke select on table "public"."TbVisitante" from "service_role";

revoke trigger on table "public"."TbVisitante" from "service_role";

revoke truncate on table "public"."TbVisitante" from "service_role";

revoke update on table "public"."TbVisitante" from "service_role";

alter table "public"."TbCliente" drop constraint "TbCliente_cdUser_fkey";

alter table "public"."TbDestinatario" drop constraint "TbDestinatario_cdUser_fkey";

alter table "public"."TbDispositivo" drop constraint "TbDispositivo_cdUser_fkey";

alter table "public"."TbEndereco" drop constraint "tbendereco_cduser_fkey";

alter table "public"."TbImagens" drop constraint "TbImagens_cdUser_fkey";

alter table "public"."TbPosicao" drop constraint "TbPosicao_cdUser_fkey";

alter table "public"."TbProduto" drop constraint "TbProduto_cdUser_fkey";

alter table "public"."TbProdutoItem" drop constraint "TbProdutoItem_cdUser_fkey";

alter table "public"."TbSensor" drop constraint "TbSensor_cdUser_fkey";

alter table "public"."TbTag" drop constraint "TbTag_cdUser_fkey";

alter table "public"."TbTipoSensor" drop constraint "TbTipoSensor_cdUser_fkey";

drop view if exists "public"."AntigoVwRelHistoricoDispositivoProduto";

drop view if exists "public"."vwrelhistoricodispositivoproduto";

drop view if exists "public"."VwProdutosFora";

drop view if exists "public"."VwRelDadosDispositivo";

drop view if exists "public"."VwRelHistoricoDispositivoProduto";

drop view if exists "public"."VwTbDestinatarioDispositivo";

drop view if exists "public"."VwTbPosicaoAtual";

drop view if exists "public"."VwTbProdutoTotalStatus";

drop view if exists "public"."VwTbProdutoTotal";

drop view if exists "public"."VwTbProdutoTipo";

alter table "public"."TbAcessoIntelBras" drop constraint "TbAcessoIntelBras_pkey";

alter table "public"."TbChamados" drop constraint "TbChamados_pkey";

alter table "public"."TbEtiqueta" drop constraint "TbEtiqueta_pkey";

alter table "public"."TbFuncionario" drop constraint "TbFuncionario_pkey";

alter table "public"."TbPonto" drop constraint "TbPonto_pkey";

alter table "public"."TbTag" drop constraint "TbTag_pkey";

alter table "public"."TbTicket" drop constraint "TbTicket_pkey";

alter table "public"."TbTicketResumo" drop constraint "TbTicketResumo_pkey";

alter table "public"."TbUnidade" drop constraint "TbUnidade_pkey";

alter table "public"."TbVisita" drop constraint "TbVisita_pkey";

alter table "public"."TbVisitante" drop constraint "TbVisitante_pkey";

drop index if exists "public"."TbAcessoIntelBras_pkey";

drop index if exists "public"."TbChamados_pkey";

drop index if exists "public"."TbEtiqueta_pkey";

drop index if exists "public"."TbFuncionario_pkey";

drop index if exists "public"."TbPonto_pkey";

drop index if exists "public"."TbTag_pkey";

drop index if exists "public"."TbTicketResumo_pkey";

drop index if exists "public"."TbTicket_pkey";

drop index if exists "public"."TbUnidade_pkey";

drop index if exists "public"."TbVisita_pkey";

drop index if exists "public"."TbVisitante_pkey";

drop table "public"."TbAcessoIntelBras";

drop table "public"."TbChamados";

drop table "public"."TbEtiqueta";

drop table "public"."TbFuncionario";

drop table "public"."TbPonto";

drop table "public"."TbTag";

drop table "public"."TbTicket";

drop table "public"."TbTicketResumo";

drop table "public"."TbUnidade";

drop table "public"."TbVisita";

drop table "public"."TbVisitante";

alter table "public"."TbCliente" drop column "cdUser";

alter table "public"."TbDestinatario" drop column "cdUser";

alter table "public"."TbDispositivo" drop column "cdUser";

alter table "public"."TbEndereco" drop column "cdUser";

alter table "public"."TbEndereco" drop column "dsObs";

alter table "public"."TbImagens" drop column "cdUser";

alter table "public"."TbPosicao" drop column "cdUser";

alter table "public"."TbPosicao" drop column "dsArquivo";

alter table "public"."TbPosicao" drop column "dsModelo";

alter table "public"."TbPosicao" drop column "dtData";

alter table "public"."TbPosicao" drop column "dtHora";

alter table "public"."TbProduto" drop column "cdUser";

alter table "public"."TbProdutoItem" drop column "cdUser";

alter table "public"."TbSensor" drop column "cdUser";

alter table "public"."TbTipoSensor" drop column "cdUser";

drop sequence if exists "public"."TbAcessoIntelBras_cdAcessoIntelBras_seq";

drop sequence if exists "public"."TbChamados_cdChamados_seq";

drop sequence if exists "public"."TbEtiqueta_cdEtiqueta_seq";

drop sequence if exists "public"."TbFuncionario_cdFuncionario_seq";

drop sequence if exists "public"."TbPonto_cdPonto_seq";

drop sequence if exists "public"."TbTag_cdTag_seq";

drop sequence if exists "public"."TbTicketResumo_cdTicketResumo_seq";

drop sequence if exists "public"."TbTicket_cdTicket_seq";

drop sequence if exists "public"."TbUnidade_cdUnidade_seq";

drop sequence if exists "public"."TbVisita_cdVisita_seq";

drop sequence if exists "public"."TbVisitante_cdVisitante_seq";

alter table "public"."TbDestinatario" add constraint "TbDestinatario_cdEndereco_fkey" FOREIGN KEY ("cdEndereco") REFERENCES "TbEndereco"("cdEndereco") not valid;

alter table "public"."TbDestinatario" validate constraint "TbDestinatario_cdEndereco_fkey";

create or replace view "public"."VwProdutosFora" as  SELECT pr."cdProduto",
    count(*) AS dispositivo_count
   FROM (("TbPosicao" ps
     JOIN "TbDispositivo" d ON ((d."cdDispositivo" = ps."cdDispositivo")))
     JOIN "TbProduto" pr ON ((pr."cdProduto" = d."cdProduto")))
  WHERE ((ps."blArea" = false) AND (ps."dtRegistro" IN ( SELECT max("TbPosicao"."dtRegistro") AS max
           FROM "TbPosicao"
          GROUP BY "TbPosicao"."cdDispositivo")))
  GROUP BY pr."cdProduto"
  ORDER BY pr."cdProduto";


create or replace view "public"."VwRelHistoricoDispositivoProduto" as  SELECT pd."cdProduto",
    pd."nrCodigo",
    pd."dsDescricao",
    p."dtRegistro",
    d."cdDispositivo",
    dest."dsNome",
    p."dsEndereco",
    s."cdSensor",
    concat((((
        CASE
            WHEN (p."nrBat" > (3.7)::double precision) THEN (3.7)::double precision
            ELSE p."nrBat"
        END / (3.7)::double precision) * (100)::double precision))::numeric(15,2), '%') AS "nrBatPercentual",
    ( SELECT srr."nrValor"
           FROM (("TbSensorRegistro" srr
             JOIN "TbSensor" ts_1 ON ((ts_1."cdSensor" = srr."cdSensor")))
             JOIN "TbTipoSensor" tts ON ((ts_1."cdTipoSensor" = tts.id)))
          WHERE ((srr."cdDispositivo" = p."cdDispositivo") AND (srr."cdPosicao" = p."cdPosicao") AND (tts.id = 2))) AS "nrPorta",
    ( SELECT srr."nrValor"
           FROM (("TbSensorRegistro" srr
             JOIN "TbSensor" ts_1 ON ((ts_1."cdSensor" = srr."cdSensor")))
             JOIN "TbTipoSensor" tts ON ((ts_1."cdTipoSensor" = tts.id)))
          WHERE ((srr."cdDispositivo" = p."cdDispositivo") AND (srr."cdPosicao" = p."cdPosicao") AND (tts.id = 4))) AS "nrTemperatura",
    (( SELECT srr."nrValor"
           FROM (("TbSensorRegistro" srr
             JOIN "TbSensor" ts_1 ON ((ts_1."cdSensor" = srr."cdSensor")))
             JOIN "TbTipoSensor" tts ON ((ts_1."cdTipoSensor" = tts.id)))
          WHERE ((srr."cdDispositivo" = p."cdDispositivo") AND (srr."cdPosicao" = p."cdPosicao") AND (ts_1."cdSensor" = s."cdSensor") AND (tts.id = 5))))::double precision AS "nrPessoas",
    pi."dsNome" AS "dsProdutoItem",
    (( SELECT srr."nrValor"
           FROM (("TbSensorRegistro" srr
             JOIN "TbSensor" ts_1 ON ((ts_1."cdSensor" = srr."cdSensor")))
             JOIN "TbTipoSensor" tts ON ((ts_1."cdTipoSensor" = tts.id)))
          WHERE ((srr."cdDispositivo" = p."cdDispositivo") AND (srr."cdPosicao" = p."cdPosicao") AND (tts.id = 1) AND (pi."cdProdutoItem" = ts_1."cdProdutoItem"))))::double precision AS "nrQtdItens",
    (sr."nrValor")::double precision AS "nrLeituraSensor",
    ts."dsNome" AS "dsTipoSensor",
    ts."dsUnidade" AS "dsUnidadeMedida",
        CASE
            WHEN (p."blArea" = false) THEN 'Fora de Área'::text
            ELSE 'Dentro da Área'::text
        END AS "dsStatus",
    d."cdStatus" AS "dsStatusDispositivo",
    pi."nrPesoUnit" AS "nrPesoUnitario",
    pi."nrLarg",
    pi."nrComp",
    pi."nrAlt",
    s."nrUnidadeIni",
    s."nrUnidadeFim",
    p."cdPosicao"
   FROM ((((((("TbSensor" s
     LEFT JOIN "TbProdutoItem" pi ON ((s."cdProdutoItem" = pi."cdProdutoItem")))
     JOIN "TbDispositivo" d ON ((d."cdDispositivo" = s."cdDispositivo")))
     JOIN "TbSensorRegistro" sr ON ((sr."cdSensor" = s."cdSensor")))
     JOIN "TbTipoSensor" ts ON ((ts.id = s."cdTipoSensor")))
     JOIN "TbPosicao" p ON ((p."cdPosicao" = sr."cdPosicao")))
     JOIN "TbDestinatario" dest ON ((dest."cdDestinatario" = d."cdDestinatario")))
     JOIN "TbProduto" pd ON ((pd."cdProduto" = d."cdProduto")))
  ORDER BY p."dtRegistro" DESC;


create or replace view "public"."VwTbDestinatarioDispositivo" as  SELECT a."cdDestinatario",
    a."dsLat",
    a."dsLong",
    a."nrRaio",
    b."cdDispositivo",
    b."cdCliente"
   FROM ("TbDestinatario" a
     JOIN "TbDispositivo" b ON ((a."cdDestinatario" = b."cdDestinatario")));


create or replace view "public"."VwTbPosicaoAtual" as  SELECT "A"."cdPosicao",
    "A"."dtRegistro",
    "A"."cdDispositivo",
    "A"."dsLat",
    "A"."dsLong",
    "A"."dsEndereco",
    "A"."dsNum",
    "A"."dsCep",
    "A"."dsBairro",
    "A"."dsCidade",
    "A"."dsUF",
    "A"."dsPais",
    "A"."nrBat",
    "B"."nrCodigo",
    "B"."cdProduto",
    "B"."dsNome" AS "dsProduto",
    "B"."dsDescricao",
    "E"."cdStatus",
    "A"."blArea",
    "E"."cdCliente"
   FROM ((("TbPosicao" "A"
     JOIN "TbDispositivo" "E" ON (("A"."cdDispositivo" = "E"."cdDispositivo")))
     JOIN "TbProduto" "B" ON (("E"."cdProduto" = "B"."cdProduto")))
     JOIN ( SELECT max("TbPosicao"."cdPosicao") AS "cdPosicao"
           FROM "TbPosicao"
          GROUP BY "TbPosicao"."cdDispositivo") "D" ON (("A"."cdPosicao" = "D"."cdPosicao")));


create or replace view "public"."VwTbProdutoTipo" as  SELECT a."cdProduto",
    a."dsNome",
    a."dsDescricao",
    a."nrCodigo",
    a."nrLarg",
    a."nrComp",
    a."nrAlt",
    a."cdStatus",
    c."cdDispositivo",
    c."dsDispositivo",
    c."dsModelo",
    c."dsDescricao" AS "DescDispositivo",
    c."dsObs",
    c."dsLayout",
    c."nrChip",
    c."cdStatus" AS "StatusDispositivo",
    c."cdCliente"
   FROM ("TbProduto" a
     JOIN "TbDispositivo" c ON ((a."cdProduto" = c."cdProduto")))
  GROUP BY a."cdProduto", a."dsNome", a."dsDescricao", a."nrCodigo", a."nrLarg", a."nrComp", a."nrAlt", a."cdStatus", c."cdDispositivo", c."dsDispositivo", c."dsModelo", c."dsDescricao", c."dsObs", c."dsLayout", c."nrChip", c."cdStatus";


create or replace view "public"."VwTbProdutoTotal" as  SELECT "VwTbProdutoTipo"."dsNome",
    "VwTbProdutoTipo"."cdProduto",
    "VwTbProdutoTipo"."dsDescricao",
    "VwTbProdutoTipo"."nrCodigo",
    "VwTbProdutoTipo"."nrLarg",
    "VwTbProdutoTipo"."nrComp",
    "VwTbProdutoTipo"."nrAlt",
    count("VwTbProdutoTipo"."cdProduto") AS "nrQtde",
    "VwTbProdutoTipo"."cdCliente"
   FROM "VwTbProdutoTipo"
  GROUP BY "VwTbProdutoTipo"."cdProduto", "VwTbProdutoTipo"."dsNome", "VwTbProdutoTipo"."dsDescricao", "VwTbProdutoTipo"."nrCodigo", "VwTbProdutoTipo"."nrLarg", "VwTbProdutoTipo"."nrComp", "VwTbProdutoTipo"."nrAlt", "VwTbProdutoTipo"."dsDispositivo", "VwTbProdutoTipo"."dsModelo", "VwTbProdutoTipo"."cdCliente";


create or replace view "public"."VwTbProdutoTotalStatus" as  SELECT "VwTbProdutoTipo"."cdProduto",
    "VwTbProdutoTipo"."dsNome",
    "VwTbProdutoTipo"."dsDescricao",
    "VwTbProdutoTipo"."nrCodigo",
    "VwTbProdutoTipo"."nrLarg",
    "VwTbProdutoTipo"."nrComp",
    "VwTbProdutoTipo"."nrAlt",
    "VwTbProdutoTipo"."StatusDispositivo",
    count("VwTbProdutoTipo"."StatusDispositivo") AS "nrQtde",
    c."nrQtde" AS "QtdeTotal",
    "VwTbProdutoTipo"."cdCliente"
   FROM ("VwTbProdutoTipo"
     LEFT JOIN "VwTbProdutoTotal" c ON (("VwTbProdutoTipo"."cdProduto" = c."cdProduto")))
  GROUP BY c."nrQtde", "VwTbProdutoTipo"."StatusDispositivo", "VwTbProdutoTipo"."cdProduto", "VwTbProdutoTipo"."dsNome", "VwTbProdutoTipo"."dsDescricao", "VwTbProdutoTipo"."nrCodigo", "VwTbProdutoTipo"."nrLarg", "VwTbProdutoTipo"."nrComp", "VwTbProdutoTipo"."nrAlt", "VwTbProdutoTipo"."dsDispositivo", "VwTbProdutoTipo"."dsModelo", "VwTbProdutoTipo"."DescDispositivo", "VwTbProdutoTipo"."cdCliente";


create or replace view "public"."VwRelDadosDispositivo" as  SELECT "A"."cdProduto",
    "A"."dsNome",
    "C"."cdDispositivo",
    (((
        CASE
            WHEN ("C"."nrBat" > (3.7)::double precision) THEN (3.7)::double precision
            ELSE "C"."nrBat"
        END / (3.7)::double precision) * (100)::double precision))::numeric(15,2) AS "nrBat",
    "E"."dsNome" AS "dsNomeDest",
    "E"."dsLogradouro" AS "dsEnderecoDest",
    "E"."nrNumero" AS "nrNumeroDest",
    "E"."dsBairro" AS "dsBairroDest",
    "E"."dsCidade" AS "dsCidadeDest",
    "E"."dsUF" AS "dsUfDest",
    "E"."dsCep" AS "dsCepDest",
    "E"."dsLat" AS "dsLatDest",
    "E"."dsLong" AS "dsLongDest",
    "E"."nrRaio" AS "dsRaio",
    "C"."dsEndereco" AS "dsEnderecoAtual",
    "C"."dsNum" AS "dsNumeroAtual",
    "C"."dsBairro" AS "dsBairroAtual",
    "C"."dsCidade" AS "dsCidadeAtual",
    "C"."dsUF" AS "dsUFAtual",
    "C"."dsCep" AS "dsCEPAtual",
    "C"."dsLat" AS "dsLatAtual",
    "C"."dsLong" AS "dsLongAtual",
    "C"."blArea",
    "C"."dtRegistro",
    "F"."dtRegistro" AS "dtCadastro",
    "F"."cdCliente"
   FROM ((("TbProduto" "A"
     JOIN "TbDispositivo" "F" ON (("F"."cdProduto" = "A"."cdProduto")))
     JOIN "VwTbPosicaoAtual" "C" ON (("F"."cdDispositivo" = "C"."cdDispositivo")))
     JOIN "TbDestinatario" "E" ON (("F"."cdDestinatario" = "E"."cdDestinatario")));



